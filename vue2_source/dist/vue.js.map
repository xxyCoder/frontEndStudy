{"version":3,"file":"vue.js","sources":["../src/compiler/index.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["// 对模板进行编译处理\r\n// 标签名 a-aaa\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\r\n// 命名空间标签 aa:aa-xxx\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\n// 开始标签-捕获标签名\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);\r\n// 结束标签-匹配标签结尾的 </div>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\r\n// 匹配属性\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\n// 匹配标签结束的 >\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\n// 匹配 {{ }} 表达式\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\r\n\r\nfunction parseHTML(html) {  // 对于vue2来说，一开始一定是<\r\n\r\n    const ELEMENT_TYPE = 1;\r\n    const TEXT_TYPE = 3;\r\n    const stack = [];\r\n    let top,root;\r\n\r\n    function createASTElement(tag,attrs) {\r\n        return {\r\n            tag,\r\n            type: ELEMENT_TYPE,\r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        };\r\n    }\r\n\r\n    // 最终需要转换成一颗抽象语法树\r\n    function start(tag,attrs) {\r\n        let node = createASTElement(tag,attrs);\r\n        if(!root) { // 如果是空树，那么将当前节点当作根节点\r\n            root = node;\r\n        }\r\n        if(top) {   // 父子节点双向记住\r\n            node.parent = top;\r\n            top.children.push(node);\r\n        }\r\n        stack.push(node);\r\n        top = node;\r\n    }\r\n\r\n    function chars(text) {  \r\n        text = text.replace(/\\s/g,'');\r\n        text && top.children.push({ // 文本直接放到当前节点中\r\n            type: TEXT_TYPE,\r\n            text,\r\n            parent: top\r\n        });\r\n    }\r\n\r\n    function end(tag) {\r\n        let node = stack.pop();\r\n        if(node !== tag) {  // 校验是否合法\r\n            // todo...\r\n        }\r\n        top = stack = stack[stack.length - 1];\r\n    }\r\n\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);   // 截取，才好继续匹配后面的内容\\\r\n            // 如果不是结束标签就一直匹配\r\n            let attr, end;\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                advance(attr[0].length);\r\n                match.attrs.push({name: attr[1],value: attr[3] || attr[4] || attr[5]});\r\n            }\r\n            if (end) {\r\n                advance(end[0].length);\r\n            }\r\n            return match;\r\n        }\r\n\r\n\r\n        return false;   // 不是开始标签\r\n    }\r\n\r\n    while (html) {\r\n        // textEnd = 0,说明是一个开始标签或结束标签 <div>   ></div>\r\n        // textEnd > 0,说明是文本的结束位置 xxxx</div>\r\n        let textEnd = html.indexOf('<');\r\n        if(textEnd == 0) {\r\n            const startTagMatch = parseStartTag();\r\n            if(startTagMatch) {\r\n                start(startTagMatch.tagName,startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if(endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n        }\r\n        else if(textEnd > 0) {  \r\n            let text = html.substring(0,textEnd);   // 文本内容\r\n            if(text) {\r\n                chars(text);\r\n                advance(text.length);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function compileToFunction(template) {\r\n    // 将template 转换成ast语法树\r\n    let ast = parseHTML(template);\r\n    // 生成render函数 （执行后获得虚拟DOM）\r\n}","// 重写部分方法\r\nlet oldArrayProto = Array.prototype;\r\n\r\nexport let newArrayProto = Object.create(oldArrayProto);   // 复制一份\r\n// 需要重写的方法\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n];  // 其他方法如concat不会改变原数组，不需要重写\r\n\r\nmethods.forEach(method => {\r\n    newArrayProto[method] = function(...args) {\r\n        // 默认需要调用原方法\r\n        const res = oldArrayProto[method].call(this,...args);   // 需要改变this执行，谁执行的绑定为谁\r\n        // 数据劫持\r\n        let inserted;\r\n        // 调用方法的是data上的数据\r\n        switch(method) {    // 获取新增的值\r\n            case 'push': \r\n            case 'unshift': \r\n                    inserted = args;\r\n                    break;  \r\n            case 'splice':  // arr.splice(开始位置，删除个数，新增数量...)\r\n                    inserted = args.splice(2);  // 获取新增数量，即剪切掉开始位置和删除个数\r\n            default:\r\n                    break;\r\n        }\r\n        let ob = this.__ob__;\r\n        if(inserted) {\r\n            // 对新增的内容进行监测,但是拿不到Observe的observeArray\r\n            // 将observeArray从类中分离不可行，不符合要求\r\n            // 调用方法的this是Observe 中传入的data，故可以在data上将Observe实例挂载上去\r\n            ob.observeArray(inserted);\r\n        }\r\n        return res;\r\n    }\r\n})","import { newArrayProto } from \"./array\";\r\n\r\n// 对于数组来说，不推荐使用索引当作key来劫持，存在a[10000] = 1这种写法，那么劫持非常耗费性能\r\nclass Observe {\r\n    constructor(data) {\r\n        if (Array.isArray(data)) {\r\n            // this是Observe的实例,同时给数据加标识，如果有属性表示该数据被监测过\r\n            // data.__ob__ = this;\r\n            // 但是要变成不可枚举的，不然在observe死循环\r\n            Object.defineProperty(data,'__ob__',{\r\n                value: this,\r\n                enumerable: false\r\n            });\r\n            // 用户一般使用数组方法修改数组，那么重写这些方法去监控\r\n            // data.__proto__ = {} 不推荐 直接重写，那么数组其他方法也没了\r\n            data.__proto__ = newArrayProto;\r\n            // 对数组中每一个值也要检测，万一是对象\r\n            this.observeArray(data);\r\n        } else {\r\n            // Object.defineProperty 只能劫持存在的属性\r\n            this.walk(data);\r\n        }\r\n    }\r\n    walk(data) {    // 循环对象，对属性依次劫持\r\n        // 重新定义属性，对性能有影响\r\n        Object.keys(data).forEach(key => defineReactive(data, key, data[key]));\r\n    }\r\n    observeArray(data) {\r\n        data.forEach(item => observe(item));\r\n    }\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n    observe(value); // 对所有对象的属性进行劫持 使用递归\r\n    Object.defineProperty(target, key, {\r\n        get() {\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value) {    // 闭包，可以拿到value\r\n                return;\r\n            }\r\n            value = newValue;\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n    if (typeof data !== 'object' || data == null) {\r\n        return;    // 只对对象进行劫持\r\n    }\r\n    // 还需要判断一个对象是否被劫持过，劫持过就不需要重复劫持了，故需要添加一个实例来判断\r\n    if(data.__ob__ instanceof Observe) {\r\n        return data.__ob__;\r\n    }\r\n    return new Observe(data);\r\n}","import { observe } from \"./observe/index.js\";\r\n\r\nexport function initState(vm) {\r\n    // 将数据拿出来，进行数据劫持\r\n    const ops = vm.$options;\r\n    if(ops.data) {\r\n        initData(vm);\r\n    }\r\n\r\n}\r\nfunction proxy(vm,target,key) {\r\n    Object.defineProperty(vm,key,{\r\n        get() {\r\n            return vm[target][key]; // vm._data.xxx\r\n        },\r\n        set(newValue) {\r\n            if(vm[target][key] === newValue) {\r\n                return ;\r\n            }\r\n            vm[target][key] = newValue;\r\n        }\r\n    })\r\n}\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;    // 在vue2中，可能是函数也可能是对象\r\n    data = typeof data === 'function' ? data.call(vm) : data; // 是函数就执行，不是则直接赋值\r\n    vm._data = data;    // 跟踪data\r\n    // 数据劫持，vue2使用了defineProperty\r\n    observe(data);  // 此处修改data在Vue上体现不出，需要定义_data = data\r\n    // 将vm._data 使用vm代理，因为用户访问数据使用vm._data较为麻烦\r\n    for(let key in data) {\r\n        proxy(vm,'_data',key);\r\n    }\r\n}","import { compileToFunction } from \"./compiler/index.js\";\r\nimport { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue) {   // 给Vue增加init方法\r\n    Vue.prototype._init = function (options) {   // 用于初始化\r\n        const vm = this;\r\n        // 如果扩展了其他方法，也需要拿到options的话，就考虑将options放在实例上\r\n        vm.$options = options;\r\n        // 初始化状态\r\n        initState(vm);\r\n\r\n        if(options.el) {    // 说明用户传递了el\r\n            vm.$mount(options.el);  // 实习数据挂载\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this;\r\n        el = document.querySelector(el);\r\n        let ops = vm.$options;\r\n        if(!ops.render) {   // 没有渲染函数\r\n            let template;\r\n            if(!ops.template && el) {   // 也没有模板，但是有el,说明用户在body区域写了HTML标签\r\n                template = el.outerHTML;\r\n            } else {\r\n                if(el) {    // 说明用户在template处写了HTML标签\r\n                    template = ops.template;    \r\n                }\r\n            }\r\n            if(template) {\r\n                const render = compileToFunction(template);\r\n                ops.render = render;\r\n            }\r\n        }\r\n\r\n        ops.render;\r\n    }\r\n}","import { initMixin } from \"./init\";\r\n\r\n// 不使用类是因为不如函数方便添加功能\r\nfunction Vue(options) {\r\n    this._init(options);\r\n}\r\ninitMixin(Vue); // 扩展init方法\r\n\r\nexport default Vue;"],"names":["ncname","qnameCapture","concat","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","top","createASTElement","tag","attrs","type","children","parent","start","node","push","chars","text","replace","end","_readOnlyError","advance","n","substring","parseStartTag","match","tagName","length","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunction","template","oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","_oldArrayProto$method","_len","arguments","args","_key","res","call","apply","inserted","splice","ob","__ob__","observeArray","Observe","data","_classCallCheck","isArray","defineProperty","enumerable","__proto__","walk","_createClass","key","keys","defineReactive","item","observe","target","get","set","newValue","_typeof","initState","vm","ops","$options","initData","proxy","_data","initMixin","Vue","_init","options","el","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}