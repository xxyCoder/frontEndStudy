<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map</title>
</head>
<body>
    <script>
        // map
        // 构造函数
        const m1 = new Map();
        // 构造函数+初值
        const m2 = new Map([
            ["key1","val1"],
            ["key2","val2"],
            ["key3","val3"]
        ]);
        console.log(m2.size);
        // 判断是否存在
        console.log(m2.has("key1"));
        console.log(m2.get("key2"));
        // 新增键值对 可以链式调用
        m2.set("firstname","xxx")
           .set("lastName","666");
        // 删除
        m2.delete("key3");
        console.log(m2.has("key3"));
        // 全部清空
        m2.clear();
        console.log(m2.size);
        // 迭代
        const m3 = new Map().set(123,"123")
                            .set(456,"456")
                            .set(789,"789");
        for(let pair of m3.entries()) {
            console.log(pair);
        }
        for(let key of m3.keys()) {
            console.log(key);
        }
        for(let val of m3.values()) {
            console.log(val);
        }
        // weakmap
        // 构造函数
        const wm = new WeakMap();
        const k1 = {id: 1},k2 = {id: 2};
        const wm2 = new WeakMap([
            [k1,"v1"],
            [k2,"v2"]
        ]);
        console.log(wm2.has(k1));
        console.log(wm2.get(k2));
        // 原始值可以包装成对象使用
        const k3 = new String("key3");
        wm2.set(k3,"v3");
        wm2.delete(k1);
        // 用途1. 私有变量
        const User = (() => {
            const wm3 = new WeakMap();
            class User {
                constructor(id) {
                    this.idProperty = Symbol('id');
                    this.setId(id);
                }
                setPrivate(property,value) {
                    const privateMembers = wm.get(this) || {};
                    privateMembers[property] = value;
                    wm.set(this,privateMembers);
                }
                getPrivate(property) {
                    return wm.get(this)[property];
                }
                setId(id) {
                    this.setPrivate(this.idProperty,id);
                }
            }
            return User;
        })();
        
    </script>
</body>
</html>