<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生成器</title>
</head>
<body>
    <script>
        // 生成器函数声明
        function * generatorFn1() {
            console.log('foo');
            return 'foo';
        }
        // 生成器函数表达式
        let generatorFn2 = function * () {
            console.log('foo');
            yield 'foo';
            console.log('bar');
            yield 'bar';
            console.log('baz');
            yield 'baz';
            return 'qwe';
        }
        // 作为对象字面量方法
        let foo = {
            * generatorFn3() {}
        }
        // 作为类实例方法
        class Foo {
            * generatorFn4() {}
        }
        // 作为类静态方法
        class Bar {
            static * generatorFn5() {}
        }
        // 调用
        let gf1 = generatorFn1();
        console.log(gf1);
        let res1 = gf1.next();
        console.log(res1);
        // 使用yield关键字
        let fg2 = generatorFn2();
        console.log(fg2.next());
        console.log(fg2.next());
        console.log(fg2.next());
        console.log(fg2.next());
        // 增强 yield
        function * generatorFn6() {
            yield * [1,2,3];
            yield * [4,5,6];
        }
        let gf2 = generatorFn6();
        console.log(gf2.next());
        for(let x of gf2) {
            console.log(x);
        }
        // 生成器作为默认迭代器
        class Foo1 {
            constructor() {
                this.values = [1,2,3,4,5];
            }
            * [Symbol.iterator]() {
                yield * this.values;
            }
        }
        const f = new Foo1();
        for(const x of f) {
            console.log(x);
        }
        // 关闭状态
        function * generatorFn7() {
            for(const x of [1,2,3,4]) {
                yield x;
            }
        }
        console.log('----------------------');
        const gf3 = generatorFn7();
        for(const x of gf3) {
            if(x > 1) {
                console.log('stop');
                console.log(gf3.return(4));
            }
            console.log(x);
        }
        console.log(gf3.next());
        // throw
        console.log('----------------------');
        function * generatorFn8() {
            for(let x of [1,2,3,4,5]) {
                try {
                    yield x;
                } catch(e) {
                    console.log(e);
                }
            }
        }
        const gf4 = generatorFn8();
        console.log(gf4.next());
        console.log(gf4.throw('foo'));
        console.log(gf4.next());
    </script>
</body>
</html>